<!doctype html>
<html>

<head>
    <script src="../external/split.min.js"></script>
    <link href="../external/tabulator_midnight.min.css" rel="stylesheet" />
    <script type="text/javascript" src="../external/tabulator.min.js"></script>
<title><!--NAME--> - Requestor</title>

    <style>
        .flex {
            display: flex;
            flex-direction: row;
        }

        .flex>.split {
            height: 100vh;
            overflow-y: scroll;
        }

        .gutter.gutter-horizontal {
            cursor: ew-resize;
        }

        .gutter {
            background-color: #eee;
            background-repeat: no-repeat;
            background-position: 50%;
        }

        .gutter.gutter-horizontal {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==");
        }

        .heading {
            padding: 15px;
            background: #eeeeee;
            text-align: center;
            font-weight: 800;
            color: #0062cc;
            letter-spacing: 2px;
        }
    </style>
    <script>
        function createPOST() {
            var http = new XMLHttpRequest();
            var url =
                window.location.protocol + "//" + window.location.hostname + ":" +
                window.location.port + window.location.pathname;
            http.open("POST", url, true);
            http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            return http;
        }

        function executePOST(URL, OKhandler, ...args) {
            http = createPOST();
            http.onload = function() {
                if (http.status != 200) {
                    alert(http.response);
                } else {
                    OKhandler(http.response, ...args);
                }
            };
            http.onerror = function() {
                alert("request error");
            };
            http.send(URL);
        }

        function loadRightPart(url) {
            executePOST(url, function(response, ...args) {
                var tmp = document.createElement("div");
                tmp.innerHTML = response;
                const scriptElements = tmp.querySelectorAll("script");
                Array.from(scriptElements).forEach((scriptElement) => {
                    const clonedElement = document.createElement("script");
                    Array.from(scriptElement.attributes).forEach((attribute) => {
                        clonedElement.setAttribute(attribute.name, attribute.value);
                    });
                    clonedElement.text = scriptElement.text;
                    scriptElement.parentNode.replaceChild(clonedElement, scriptElement);
                });
                document.getElementById("two").innerHTML = "";
                document.getElementById("two").appendChild(tmp);
            });
            return false;
        }

        function savefile() {
            http = createPOST();
            http.onload = function() {
                if (http.status != 200) {
                    alert(http.response);
                } else {}
            };

            http.onerror = function() {
                alert("request error");
            };

            const params = new URLSearchParams(window.location.search);
            http.send("file=" + params.get("file") + "&op=savefile");
        }
    </script>
</head>

<body>
    <div id='mainfile'>
<button title='Return to index' onclick="window.location.href='/';">&lt;</button>
&nbsp;&nbsp;&nbsp;<button title='Saves changes to file (with backup)' onclick="savefile();">Save</button>
&nbsp;&nbsp;&nbsp;&nbsp;<button title='Run everything from file'>Run all</button>
    </div>

    <div class="flex">
        <div id="one" class="split">
            <!--FOLDERS_MENU-->
        </div>
        <input type="hidden" id="id" />
        <div id="two" class="split">
            <!--OBIEKT-->
            <!--RUN-->
        </div>
    </div>

    <script>
        Split(["#one", "#two"], {
            sizes: [20, 80],
        });
    </script>

</body>

</html>