<!doctype html>
<html>

<head>
<title>Requestor</title>
</head><body>
    <!--FILES-->
    
<p>
    <button onclick='addFile();return false;'>
        New file
    </button>
    
    <script>
    
        function createPOST() {
            var http = new XMLHttpRequest();
            var url =
                window.location.protocol + "//" + window.location.hostname + ":" +
                window.location.port + window.location.pathname;
            http.open("POST", url, true);
            http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            return http;
        }

        function executePOST(URL, OKhandler, ...args) {
            http = createPOST();
            http.onload = function() {
                if (http.status != 200) {
                    alert(http.response);
                } else {
                    OKhandler(http.response, ...args);
                }
            };
            http.onerror = function() {
                alert("request error");
            };
            http.send(URL);
        }
        
    function addFile() {
        while (true) {
            var x = prompt("Please enter new file name");
            if (x == null) break;
            if (x == "") continue;
             executePOST("op=newfile&" + "name=" + x,
                        function(...args) {
window.location.href='/';                            
                        },
                        x,
                    );
            break;
        }
    }

</script>
</body>

</html>
